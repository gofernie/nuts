---
const {
  title = "Fernie Real Estate",
  showHeader = true,
  class: bodyClass = "",
} = Astro.props;
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <slot name="head" /> <!-- ✅ pages can preload their hero here -->

    <style>
      :root{
        --header-h: 52px;
        --bg: #fafaf9;
        --ink: #111827;
        --ink-muted: #1f2937;
        --hover-bg: rgba(243,244,246,.9);
        --hero-h: 48vh;
        --container-w: 1200px;
        --container-pad: 12px;
        --bleed-fix: 2px; /* 1–2px kills hairlines */
      }

      *,*::before,*::after{ box-sizing:border-box; }
      @supports (scrollbar-gutter: stable){ html{ scrollbar-gutter: stable; } }
      html,body{ height:100%; overflow-x: clip; }

      body{
        margin:0;
        font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
        background: var(--bg);
        color: var(--ink);
      }

      header{
        position:fixed; top:0; left:0; right:0;
        height:var(--header-h); z-index:100;
        background: rgba(255,255,255,.84);
        backdrop-filter: blur(10px);
        border-bottom:1px solid #e5e7eb;
      }

      .nav-inner{
        max-width: var(--container-w);
        margin:0 auto; height:100%;
        padding:0 var(--container-pad);
        display:flex; align-items:center;
      }

      .brand{ font-weight:700; font-size:1rem; color:var(--ink); text-decoration:none; padding:4px 6px; border-radius:6px; }
      .brand:hover{ background: var(--hover-bg); }
      .spacer{ flex:1; }

      nav{ display:flex; align-items:center; gap:12px; }
      nav a{ color:var(--ink-muted); padding:4px 6px; text-decoration:none; border-radius:6px; font-weight:500; line-height:1; }
      nav a:hover, nav a:focus-visible{ color:var(--ink); background: var(--hover-bg); }

      .hamburger{ display:none; background:none; border:none; font-size:1.5rem; cursor:pointer; color:var(--ink-muted); }
      @media (max-width:768px){
        nav{ position:absolute; top:var(--header-h); right:0; background:#fff; flex-direction:column; align-items:flex-start; gap:0; padding:8px 12px; display:none; box-shadow:0 2px 8px rgba(0,0,0,.1); }
        nav.open{ display:flex; }
        nav a{ display:block; width:100%; padding:8px 0; }
        .hamburger{ display:block; }
      }

      main{ margin:0; padding:0; }
    </style>

    <!-- GLOBAL styles for content inside <slot/> -->
    <style is:global>
      /* Gap-proof full-bleed container */
      .hero-bleed{
        position: relative;
        left: 50%;
        right: 50%;
        width: calc(100vw + var(--bleed-fix) * 2);
        margin-left: calc(-50vw - var(--bleed-fix));
        margin-right: calc(-50vw - var(--bleed-fix));
        min-height: var(--hero-h);
        padding-top: var(--header-h);
        background-color:#e5e7eb; /* visible if no img */
        border-bottom:1px solid #eee;
        transform: translateZ(0);
        overflow: hidden; /* clip overdraw */
      }
      /* The LCP img fills the hero */
      .hero-bleed > img{
        position:absolute; inset:0;
        width:100%; height:100%;
        object-fit:cover; object-position:center;
        display:block; border:0;
      }

      .container{
        max-width: var(--container-w);
        margin-inline:auto;
        padding-inline: var(--container-pad);
      }

      img{ display:block; max-width:100%; height:auto; }
    </style>

    <script is:inline>
      function toggleNav(){ document.querySelector("nav")?.classList.toggle("open"); }
      window.toggleNav = toggleNav;
    </script>
  </head>
  <body class={bodyClass}>
    {showHeader && (
      <header>
        <div class="nav-inner">
          <a class="brand" href="/">Fernie Real Estate</a>
          <span class="spacer"></span>
          <button class="hamburger" onclick="toggleNav()">☰</button>
          <nav>
            <a href="/neighbourhoods">Neighbourhoods</a>
            <a href="/types">Types</a>
            <a href="/contact">Contact</a>
          </nav>
        </div>
      </header>
    )}
    <main>
      <slot />
    </main>
  </body>
</html>
