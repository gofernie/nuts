---
// File: src/pages/search/index.astro
export const prerender = true;

import Site from "../../layouts/Site.astro";
import RVEmbed from "../../components/RVEmbed.astro";

// SEO only (no visible heading/summary on the page)
const seo_title = "Search Fernie Real Estate Listings";
const seo_description =
  "Live Fernie MLSÂ® search: homes, condos, townhomes, investment properties.";

const rvBlockId = "MQP2VMLT-HDQLLMRY";
const hasValidBlock = /^[A-Z0-9]{8}-[A-Z0-9]{8}$/i.test(rvBlockId);
---

<Site title="Search" seo_title={seo_title} seo_description={seo_description}>
  <div class="search-shell">
    {hasValidBlock ? (
      <div class="rv-host">
        <RVEmbed block={rvBlockId} minHeight="1000px" showSkeleton={false} />
      </div>
    ) : (
      <div class="rv-fallback">
        <p>Search embed unavailable right now.</p>
        <p><a href="/neighbourhoods">Browse by neighbourhood</a></p>
      </div>
    )}
  </div>

  <style>
    /* Page container (no visible headings) */
    .search-shell {
      max-width: 1200px;
      margin: 90px auto 32px;   /* below fixed header + spacing */
      padding: 0 12px;
    }

    .rv-fallback {
      margin-top: 12px;
      padding: 12px 16px;
      background: #fff3cd;
      border: 1px solid #ffe69c;
      border-radius: 10px;
      color: #5c3c00;
    }

    /* Center the RealtyVis widget */
    .rv-host .rv-root,
    .rv-host .rv-container,
    .rv-host .rv-shell {
      max-width: 1200px;
      margin-left: auto;
      margin-right: auto;
      display: block;
    }

    /* Remove shimmer/loading placeholders for a clean load */
    .rv-host [class*="skeleton"],
    .rv-host [class*="Skeleton"],
    .rv-host [class*="loading"],
    .rv-host [data-skeleton],
    .rv-host .rv-skeleton,
    .rv-host .loading-skeleton,
    .rv-host .rv-loading {
      animation: none !important;
      background: none !important;
      background-image: none !important;
      box-shadow: none !important;
      opacity: 0 !important;
      pointer-events: none !important;
    }
    .rv-host * {
      animation-duration: 0s !important;
      transition: none !important;
    }

    @media (max-width: 900px) {
      .rv-host .rv-root {
        padding-inline: 10px;
      }
    }
  </style>
</Site>
